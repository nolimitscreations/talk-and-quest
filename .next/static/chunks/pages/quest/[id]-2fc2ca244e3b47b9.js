(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{7580:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/quest/[id]",function(){return n(9212)}])},2838:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var s=n(5893),i=n(1664),r=n.n(i),a=n(9103);function l(e){let{children:t}=e,{profile:n,setProfile:i,quiet:l,setQuiet:c}=(0,a.q)();return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"header",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(r(),{href:"/",children:(0,s.jsx)("span",{style:{fontWeight:800,fontSize:18,cursor:"pointer"},children:"Talk & Quest"})}),(0,s.jsx)("span",{className:"badge",children:l?"quiet mode":"gentle practice"})]}),(0,s.jsxs)("div",{className:"flex",style:{gap:8},children:[(0,s.jsxs)("select",{value:n,onChange:e=>i(e.target.value),children:[(0,s.jsx)("option",{children:"Samuel"}),(0,s.jsx)("option",{children:"Spencer"}),(0,s.jsx)("option",{children:"Guest"})]}),(0,s.jsx)("button",{className:"btn ghost",onClick:()=>c(!l),children:l?"\uD83D\uDD15 Quiet":"\uD83D\uDD14 Normal"}),(0,s.jsx)(r(),{href:"/dashboard",children:(0,s.jsx)("button",{className:"btn",children:"Dashboard"})})]})]}),t,(0,s.jsx)("footer",{children:"Made with calm vibes for Samuel & Spencer • Local-first • No pressure"})]})}},8887:function(e,t,n){"use strict";function s(){let e=function(){try{let e=localStorage.getItem("tq_settings");return e?JSON.parse(e):{profile:"Samuel",quiet:!1}}catch(e){return{profile:"Samuel",quiet:!1}}}().profile||"Samuel";return"tq_progress_".concat(e)}function i(){try{let e=localStorage.getItem(s());return e?JSON.parse(e):{minutes:0,attempts:0,stickers:[]}}catch(e){return{minutes:0,attempts:0,stickers:[]}}}function r(e){localStorage.setItem(s(),JSON.stringify(e))}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=i();t.attempts+=e,r(t)}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=i();t.minutes+=e,r(t)}function c(e){let t=i();t.stickers.includes(e)||t.stickers.push(e),r(t)}n.d(t,{rj:function(){return a},mH:function(){return l},du:function(){return c}})},9212:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var s=n(5893),i=n(1163),r=n(2838),a=n(2510),l=n(7294),c=n(9103);function o(e){let{text:t,label:n="\uD83D\uDD0A Hear it"}=e,{quiet:i}=(0,c.q)();return(0,s.jsx)("button",{className:"btn ghost",onClick:()=>{let e=new SpeechSynthesisUtterance(t);e.rate=i?.85:.95,e.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(e)},children:n})}var u=n(8887);function d(e){let{onTranscript:t}=e;return(0,s.jsx)("button",{className:"btn",onClick:()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e){alert("Speech recognition not supported in this browser. You can still practice out loud!");return}let n=new e;n.lang="en-US",n.interimResults=!1,n.maxAlternatives=1,n.onresult=e=>{let n=e.results[0][0].transcript;(0,u.rj)(1),t&&t(n)},n.onerror=()=>{},n.onend=()=>{},n.start()},children:"\uD83C\uDF99️ Say it"})}var h=n(4616);function p(e){let{onTranscript:t}=e,[n,i]=(0,l.useState)(!1),r=async()=>{i(!0);try{let e=await fetch("/api/azure-token");if(!e.ok){alert("Azure Speech is not configured yet."),i(!1);return}let{token:n,region:s}=await e.json(),r=h.SpeechConfig.fromAuthorizationToken(n,s);r.speechRecognitionLanguage="en-US";let a=h.AudioConfig.fromDefaultMicrophoneInput(),l=new h.SpeechRecognizer(r,a);l.recognizeOnceAsync(e=>{i(!1),e.text?((0,u.rj)(1),t&&t(e.text)):t&&t(""),l.close()},e=>{i(!1),l.close()})}catch(e){i(!1)}};return(0,s.jsx)("button",{className:"btn",onClick:r,disabled:n,children:n?"Listening...":"\uD83C\uDF99️ Say it (Azure)"})}function f(e){let{items:t=[],onComplete:n,reward:i}=e,[r,a]=(0,l.useState)(0),[c,h]=(0,l.useState)(""),f=t[r]||"",m=()=>{r+1<t.length?a(r+1):(i&&(0,u.du)(i),n&&n())},x=e=>{if(e&&e.trim().length>0?h('Nice try! I heard: "'.concat(e,'"')):h("Great effort! Let’s try the next one."),"undefined"!=typeof document){let e=["✨","\uD83C\uDF1F","\uD83D\uDC96","\uD83D\uDC8E"],t=document.createElement("div");t.className="sparkle",t.textContent=e[Math.floor(Math.random()*e.length)],t.style.left="50%",t.style.top="20px",t.style.transform="translateX(-50%)",document.body.appendChild(t),setTimeout(()=>t.remove(),750)}setTimeout(()=>{h(""),m()},1e3)};return(0,s.jsxs)("div",{className:"activity",children:[(0,s.jsx)("h3",{children:"Repeat After Me"}),(0,s.jsx)("p",{children:"Say the word when you’re ready. You can listen first."}),(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("div",{className:"card",style:{flex:1},children:[(0,s.jsx)("h1",{style:{textAlign:"center"},children:f}),(0,s.jsxs)("div",{className:"center",style:{gap:12,flexWrap:"wrap"},children:[(0,s.jsx)(o,{text:f}),(0,s.jsx)(p,{onTranscript:x}),(0,s.jsx)(d,{onTranscript:x}),(0,s.jsx)("button",{className:"btn secondary",onClick:m,children:"Skip"})]}),(0,s.jsx)("p",{className:"small",style:{marginTop:8},children:"Tip: On iPad, use the Azure mic for best results."}),c&&(0,s.jsx)("p",{className:"notice",style:{marginTop:12},children:c})]})})]})}function m(e){let{words:t=[],onComplete:n}=e,[i,r]=(0,l.useState)(0),a=t[i]||"";return(0,s.jsxs)("div",{className:"activity",children:[(0,s.jsx)("h3",{children:"Sight-Word Sprint (gentle)"}),(0,s.jsx)("p",{children:"Tap to hear the word. Read it with me if you want. No timers here."}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h1",{style:{textAlign:"center"},children:a}),(0,s.jsxs)("div",{className:"center",style:{gap:12},children:[(0,s.jsx)(o,{text:a,label:"\uD83D\uDD0A Say it together"}),(0,s.jsx)("button",{className:"btn",onClick:()=>{i+1<t.length?r(i+1):n&&n()},children:"Next"})]})]})]})}function x(e){let{title:t,paragraphs:n=[],questions:i=[],onComplete:r}=e,[a,c]=(0,l.useState)(0);if(a<n.length){let e=n[a];return(0,s.jsxs)("div",{className:"activity",children:[(0,s.jsxs)("h3",{children:["Fluency Story: ",t]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("p",{style:{fontSize:18},children:e}),(0,s.jsxs)("div",{className:"center",style:{gap:12},children:[(0,s.jsx)(o,{text:e,label:"\uD83D\uDD0A Echo read"}),(0,s.jsx)("button",{className:"btn",onClick:()=>c(a+1),children:"Next line"})]})]})]})}let u=a-n.length;if(u<i.length){let e=i[u],t=()=>c(a+1);return(0,s.jsxs)("div",{className:"activity",children:[(0,s.jsx)("h3",{children:"Story Questions"}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("p",{style:{fontWeight:700},children:e.q}),(0,s.jsx)("div",{className:"grid",children:e.options.map((e,n)=>(0,s.jsx)("button",{className:"btn ghost",onClick:t,children:e},n))})]})]})}return(0,s.jsxs)("div",{className:"activity",children:[(0,s.jsx)("h3",{children:"Great reading!"}),(0,s.jsxs)("div",{className:"card center",style:{flexDirection:"column",gap:12},children:[(0,s.jsx)("p",{children:"You finished the story. High five ✋"}),(0,s.jsx)("button",{className:"btn",onClick:r,children:"Continue"})]})]})}function y(){let e=(0,i.useRouter)(),{id:t}=e.query,n=a.quests.find(e=>e.id===t),[c,o]=(0,l.useState)(0);if((0,l.useEffect)(()=>{c>0&&(0,u.mH)(1)},[c]),!n)return(0,s.jsx)(r.Z,{children:(0,s.jsx)("div",{className:"card",children:"Loading..."})});let d=n.activities[c],h=()=>{c+1<n.activities.length?o(c+1):e.push("/")};return(0,s.jsxs)(r.Z,{children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h2",{children:n.title}),(0,s.jsxs)("p",{className:"small",children:["Targets: ",n.targets.join(", ")," • Activity ",c+1," of ",n.activities.length]})]}),(null==d?void 0:d.type)==="repeat_after_me"&&(0,s.jsx)(f,{items:d.items,reward:n.reward,onComplete:h}),(null==d?void 0:d.type)==="sight_word_sprint"&&(0,s.jsx)(m,{words:d.words,onComplete:h}),(null==d?void 0:d.type)==="fluency_story"&&(0,s.jsx)(x,{title:d.title,paragraphs:d.paragraphs,questions:d.questions,onComplete:h})]})}},6916:function(){},9271:function(){},2104:function(){},4151:function(){},4270:function(){},2914:function(){},2088:function(){},2510:function(e){"use strict";e.exports=JSON.parse('{"quests":[{"id":"r-rocket","title":"R Rocket Quest","targets":["R-initial","R-medial","R-final"],"activities":[{"type":"repeat_after_me","items":["rain","rope","rocket","rabbit","robot","car","door"]},{"type":"sight_word_sprint","words":["because","another","between","important","through","enough","example"]},{"type":"fluency_story","title":"Skylar’s Secret Shortcut","paragraphs":["Samuel and Spencer followed Skylar along a quiet trail.","The corgi turned left at a big rock—and suddenly, a hidden playground appeared!"],"questions":[{"q":"Who found the shortcut?","options":["Skylar","A cat","A bird"],"answer":0},{"q":"Where did the trail lead?","options":["Playground","Library","Bakery"],"answer":0}]}],"reward":"/stickers/sticker_1.png"},{"id":"sh-ship","title":"SH Ship Quest","targets":["SH-initial"],"activities":[{"type":"repeat_after_me","items":["ship","shell","shop","shark","shoe"]},{"type":"sight_word_sprint","words":["favorite","different","probably","beautiful","friend"]},{"type":"fluency_story","title":"The Shiny Shell","paragraphs":["Skylar nudged a shiny shell across the sand.","Samuel and Spencer held it to their ears and heard the sea say, ‘hello!’"],"questions":[{"q":"What did Skylar find?","options":["A shell","A coin","A toy"],"answer":0}]}],"reward":"/stickers/sticker_2.png"}]}')}},function(e){e.O(0,[664,323,888,774,179],function(){return e(e.s=7580)}),_N_E=e.O()}]);